# Prometheus Configuration for BookHub Application
# This configuration works for local development and cloud deployments

global:
  # How frequently to scrape targets
  scrape_interval: 15s
  
  # How frequently to evaluate rules
  evaluation_interval: 15s
  
  # Attach these labels to any time series or alerts
  external_labels:
    monitor: 'bookhub-monitor'
    environment: 'development'

# Alertmanager configuration (optional - uncomment if you want to add alerting)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#           - alertmanager:9093

# Load rules once and periodically evaluate them
# rule_files:
#   - "alerts.yml"

# Scrape configurations
scrape_configs:
  # Scrape Prometheus itself
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
        labels:
          service: 'prometheus'

  # Scrape BookHub Node.js application
  - job_name: 'bookhub-app'
    scrape_interval: 10s
    scrape_timeout: 5s
    metrics_path: '/metrics'
    
    # For local development (Mac - app running with npm run dev)
    static_configs:
      - targets: ['host.docker.internal:5001']
        labels:
          service: 'bookhub'
          environment: 'local'
    
    # For Docker Compose setup (uncomment if running app in Docker)
    # static_configs:
    #   - targets: ['app:5000']
    #     labels:
    #       service: 'bookhub'
    #       environment: 'docker'
    
    # Uncomment for cloud deployment (Render, Railway, etc.)
    # Replace with your actual production URL
    # static_configs:
    #   - targets: ['your-app.railway.app:443']
    #     labels:
    #       service: 'bookhub'
    #       environment: 'production'
    #     scheme: https

  # Example: Scrape Node Exporter for system metrics (optional)
  # - job_name: 'node-exporter'
  #   static_configs:
  #     - targets: ['node-exporter:9100']

# Remote write configuration (optional - for cloud Prometheus instances)
# remote_write:
#   - url: "https://your-remote-prometheus/api/v1/write"
#     basic_auth:
#       username: "user"
#       password: "password"
